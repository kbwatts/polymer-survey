
<!--
    @license
    Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
    This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
    The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
    The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
    Code distributed by Google as part of the polymer project is also
    subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<!doctype html>
<html>
<head>

  <title>Simple Slideshow</title>

  <script src="https://www.polymer-project.org/components/webcomponentsjs/webcomponents.js"></script>
  <link href="https://www.polymer-project.org/components/core-animated-pages/core-animated-pages.html" rel="import">
  <link href="https://www.polymer-project.org/components/core-animated-pages/transitions/slide-from-right.html" rel="import">
  <link href="https://www.polymer-project.org/components/core-icons/core-icons.html" rel="import">
  <link href="https://www.polymer-project.org/components/paper-fab/paper-fab.html" rel="import">
  <link rel="import" href="https://www.polymer-project.org/components/paper-progress/paper-progress.html">
  <link href="https://www.polymer-project.org/components/paper-shadow/paper-shadow.html" rel="import">

  <style>
    body {
      font-family: Roboto, 'Helvetica Neue', Helvetica, Arial, sans-serif;
      margin: 0;
    }

    core-animated-pages {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0px;
      left: 0;
      font-size: 72px;
      overflow: hidden;
    }

    .controls {
      position: absolute;
      width: 100%;
      bottom: 16px;
    }

    section > div {
      height: 100%;
      color: #212121;
    }
    paper-fab {
      color: #fff;
      margin-right:2em;
      margin-left:2em;
    }

    paper-fab.blue {
      background: #5677fc;
    }

    paper-fab.green {
      background: #259b24;
    }

    paper-fab.grey {
      background: #9E9E9E;
    }
    paper-fab.light-grey {
      background: #BDBDBD;
    }
    paper-progress {
      display: block;
      width: 100%;
      padding: 25px 0;
    }
    .card {
      font-color: #424242;
      font-size: 18px;
      display: inline-block;
      background: white;
      box-sizing: border-box;
      width: 80%;
      height: 80%;
      margin: 16px;
      padding: 16px;
      border-radius: 2px;
    }

  </style>

</head>
<body unresolved>


  <core-animated-pages onclick="next();" transitions="slide-from-right">
    <section>
      <div layout vertical center center-justified style="background:#eee;">
        <paper-shadow class="card" z="2">
          Sample text
        </paper-shadow>
      </div>
    </section>
    <section>
      <div layout vertical center center-justified style="background:#eee;">
        <paper-shadow class="card" z="2">
          Sample text
        </paper-shadow>
      </div>
    </section>
    <section>
      <div layout vertical center center-justified style="background:#9C27B0;">
        <div>3</div>
      </div>
    </section>
    <section>
      <div layout vertical center center-justified style="background:#673AB7;">
        <div>4</div>
      </div>
    </section>
    <section>
      <div layout vertical center center-justified style="background:#3F51B5;">
        <div>5</div>
      </div>
    </section>
    <section>
      <div layout vertical center center-justified style="background:#2196F3;">
        <div>6</div>
      </div>
    </section>
    <section>
      <div layout vertical center center-justified style="background:#03A9F4;">
        <div>7</div>
      </div>
    </section>
    <section>
      <div layout vertical center center-justified style="background:#00BCD4;">
        <div>8</div>
      </div>
    </section>
    <section>
      <div layout vertical center center-justified style="background:#009688;">
        <div>9</div>
      </div>
    </section>
    <section>
      <div layout vertical center center-justified style="background:#4CAF50;">
        <div>10</div>
      </div>
    </section>
    <section>
      <div layout vertical center center-justified style="background:#8BC34A;">
        <div>11</div>
      </div>
    </section>
  </core-animated-pages>

  <div horizontal layout center-justified class="controls">
      <div><paper-fab mini icon="arrow-back" class="light-grey" title="arrow-back" onclick="back()"></paper-fab></div>
      <div flex><!-- <paper-progress></paper-progress> --></div>
      <div><paper-fab mini icon="arrow-forward" class="grey" title="arrow-forward" onclick="next()"></paper-fab></div>
  </div>

  <script>
    var up = true;
    var max = (document.getElementsByTagName('section').length - 1);
    var currentPage = document.querySelector('core-animated-pages');

    function next() {
      if ((currentPage.selected) < max) {
        currentPage.selected++;
        // startNextProgress();
      }
    }

    function back() {
      if ((currentPage.selected) > 0) {
        currentPage.selected--;
        // startPreviousProgress();
      }
    }

    document.onkeydown = checkKey;
    function checkKey(e) {

      e = e || window.event;

      if (((e.keyCode == '37') || (e.keyCode == '46')) && currentPage.selected > 0) {
          back();
      }
      else if (((e.keyCode == '13') || (e.keyCode == '32') || (e.keyCode == '39')) && currentPage.selected <= max) {
          next();
      }
    }

    var progress = document.querySelector('paper-progress');    
    var repeat, maxRepeat = 1, animating = false;
    
    function nextProgress() {
      console.log("currentPage.selected = " + currentPage.selected);
      // console.log("progress.value = " + progress.value);
      animating = true;
      if (progress.value < (currentPage.selected+1)*10) {
        progress.value += (progress.step || 1);
      } else {
        if (++repeat >= maxRepeat) {
          animating = false;
          return;
        }
        progress.value = progress.min;
      }
      progress.async(nextProgress);
    }


    function startNextProgress() {
      repeat = 0;
      progress.value = ((currentPage.selected)*10);
      if (!animating) {
        nextProgress();
      }
    }

    function previousProgress() {
      console.log("currentPage.selected = " + currentPage.selected);
      // console.log("progress.value = " + progress.value);
      animating = true;
      if (progress.value > (currentPage.selected-1)*10) {
        progress.value -= (progress.step || 1);
      } else {
        if (++repeat >= maxRepeat) {
          animating = false;
          return;
        }
        progress.value = progress.min;
      }
      progress.async(previousProgress);
    }

    function startPreviousProgress() {
      repeat = 0;
      progress.value = ((currentPage.selected)*10);
      if (!animating) {
        previousProgress();
      }
    }
    
    addEventListener('polymer-ready', function() {
      startNextProgress();
    });
  </script>
</body>
</html>
